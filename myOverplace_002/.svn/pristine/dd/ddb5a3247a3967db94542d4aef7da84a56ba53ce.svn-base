angular.module("starter.directive",[]).directive("constantfocus",["$timeout","$ionicScrollDelegate",function(t,e){return{restrict:"A",link:function(i,o){o[0].addEventListener("focusout",function(){o[0].focus()}),o[0].addEventListener("focus",function(){function i(o){t(function(){e.scrollBottom()},30),window.removeEventListener(o,i,o)}window.addEventListener("native.keyboardshow",i,"native.keyboardshow"),window.addEventListener("native.keyboardhide",i,"native.keyboardhide")})}}}]).directive("formValidateAfter",function(){function t(t,e,i,o){var a="form-validate";o.validate=!1,e.bind("focus",function(){o.validate&&o.$invalid?(e.addClass(a),t.$apply(function(){o.validate=!0})):(e.removeClass(a),t.$apply(function(){o.validate=!1}))}).bind("blur",function(){e.addClass(a),t.$apply(function(){o.validate=!0})})}return{restrict:"A",require:"ngModel",link:t}}).directive("socialCheckbox",["$ionicPopup",function(t){return{restrict:"E",scope:{soc:"=socialAssign",obj:"=controllerAssign",hideFacebook:"=?",disableFacebook:"=?",hideAlertTwitter:"=?",disableTwitter:"=?"},link:function(e){e.warned={facebook:!1,twitter:!1},e.alertSocial=function(i){var o;switch(i){case"facebook":o=void 0!=typeof e.disableFacebook&&1==e.disableFacebook?"Il coupon non pu&ograve; essere pubblicato su facebook finch&egrave; non sar&agrave; validato":"Facebook non configurato";break;case"twitter":o=void 0!=typeof e.disableTwitter&&1==e.disableTwitter?"Il coupon non pu&ograve; essere pubblicato su twitter finch&egrave; non sar&agrave; validato":"Twitter non configurato";break;default:o="Facebook e Twitter non configurati"}t.alert({title:"Attenzione",template:o}).then(function(){switch(i){case"facebook":e.warned.facebook=!0;break;case"twitter":e.warned.twitter=!0}})},e.alertTwitter=function(){1!=e.hideAlertTwitter&&e.obj.twitter&&t.show({title:"Attenzione",template:"La pubblicazione su Twitter avverr&agrave; immediatamente. Non &egrave; possibile impostare una pubblicazione differita",scope:e,buttons:[{text:"Annulla",onTap:function(){e.obj.twitter=!1}},{text:"Ok",type:"button-positive",onTap:function(){e.obj.twitter=!0}}]})}},templateUrl:"templates/directive/social_checkbox.html"}}]).directive("notificheCheckbox",["$ionicPopup","$ionicLoading","$cordovaToast","ListeContatti",function(t,e,i,o){return{restrict:"E",scope:{ableMessage:"=notificheMessaggi",statusCheckbox:"=statusCheckbox",obj:"=controllerAssign"},link:function(a){a.warned={sms:!1,email:!1},a.emptyListaContatti=[],a.getContactList=function(n){a.statusCheckbox[n]?(e.show({template:"<ion-spinner></ion-spinner>",noBackdrop:!1}),o.getByType(n).then(function(i){a.obj["id_lista_"+n]=0,e.hide();var o='<div class="list">';for(var r in i.liste_contatti)o+='<label class="item item-radio"><input type="radio" name="id_lista_'+n+'" ng-model="obj.id_lista_'+n+'" value="'+i.liste_contatti[r].id+'"><div class="item-content item-text-wrap">('+i.liste_contatti[r].numero_contatti+") "+i.liste_contatti[r].titolo+'</div><i class="radio-icon ion-checkmark calm"></i></label>';o+="</div>",t.show({title:"Scegli una lista contatti",template:o,subTitle:"per l&apos;invio della tua campagna "+n,scope:a,buttons:[{text:"Annulla",onTap:function(){a.statusCheckbox[n]=!1,delete a.obj["id_lista_"+n]}},{text:"Conferma",type:"button-positive",onTap:function(t){("email"==n&&(null==a.obj.id_lista_email||0==a.obj.id_lista_email)||"sms"==n&&(null==a.obj.id_lista_sms||0==a.obj.id_lista_sms))&&t.preventDefault()}}]})},function(t){e.hide(),a.emptyListaContatti[n+"_disabled"]=!0,null!==t&&"string"==typeof t?i.show(t,"short","bottom"):i.show("Errore nel recupero delle liste contatti","short","bottom")})):delete a.obj["id_lista_"+n]},a.alertMessage=function(e,i,o){t.alert({title:e,template:i}).then(function(){switch(o){case"sms":a.warned.sms=!0;break;case"email":a.warned.email=!0}})}},templateUrl:function(t,e){return"templates/directive/notifiche_checkbox_"+e.mode+".html"}}}]).directive("customMaxlength",function(){return{restrict:"A",require:"ngModel",link:function(t,e,i,o){i.$set("ngTrim","false");var a=parseInt(i.customMaxlength,10);o.$parsers.push(function(t){return t.length>a&&(t=t.substr(0,a),o.$setViewValue(t),o.$render()),t})}}}).directive("checkAvatar",function(){"use strict";return{restrict:"A",link:function(t,e,i){return i.$observe("afklLazyImageLoaded",function(t){"fail"==t&&e[0].firstChild.setAttribute("src","http://www.overplace.com/avatar/ovp/avatar_default.png")})}}});